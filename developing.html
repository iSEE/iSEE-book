<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Developing new panels | Extending iSEE</title>
  <meta name="description" content="This book describes how to use the Bioconductor iSEE package to create web-applications for exploring data stored in SummarizedExperiment objects." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Developing new panels | Extending iSEE" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book describes how to use the Bioconductor iSEE package to create web-applications for exploring data stored in SummarizedExperiment objects." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Developing new panels | Extending iSEE" />
  
  <meta name="twitter:description" content="This book describes how to use the Bioconductor iSEE package to create web-applications for exploring data stored in SummarizedExperiment objects." />
  

<meta name="author" content="Kevin Rue-Albrecht, Federico Marini, Charlotte Soneson, and Aaron Lun" />


<meta name="date" content="2020-07-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="server.html"/>
<link rel="next" href="dynamic-reduced-dimensions.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Extending <i>iSEE</i></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="panels.html"><a href="panels.html"><i class="fa fa-check"></i><b>1</b> Panel classes</a><ul>
<li class="chapter" data-level="1.1" data-path="panels.html"><a href="panels.html#overview"><i class="fa fa-check"></i><b>1.1</b> Overview</a></li>
<li class="chapter" data-level="1.2" data-path="panels.html"><a href="panels.html#virtual-classes"><i class="fa fa-check"></i><b>1.2</b> Virtual classes</a><ul>
<li class="chapter" data-level="1.2.1" data-path="panels.html"><a href="panels.html#panel"><i class="fa fa-check"></i><b>1.2.1</b> <code>Panel</code></a></li>
<li class="chapter" data-level="1.2.2" data-path="panels.html"><a href="panels.html#dotplot"><i class="fa fa-check"></i><b>1.2.2</b> <code>DotPlot</code></a></li>
<li class="chapter" data-level="1.2.3" data-path="panels.html"><a href="panels.html#columndotplot"><i class="fa fa-check"></i><b>1.2.3</b> <code>ColumnDotPlot</code></a></li>
<li class="chapter" data-level="1.2.4" data-path="panels.html"><a href="panels.html#rowdotplot"><i class="fa fa-check"></i><b>1.2.4</b> <code>RowDotPlot</code></a></li>
<li class="chapter" data-level="1.2.5" data-path="panels.html"><a href="panels.html#table"><i class="fa fa-check"></i><b>1.2.5</b> <code>Table</code></a></li>
<li class="chapter" data-level="1.2.6" data-path="panels.html"><a href="panels.html#columntable"><i class="fa fa-check"></i><b>1.2.6</b> <code>ColumnTable</code></a></li>
<li class="chapter" data-level="1.2.7" data-path="panels.html"><a href="panels.html#rowtable"><i class="fa fa-check"></i><b>1.2.7</b> <code>RowTable</code></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="panels.html"><a href="panels.html#concrete-classes"><i class="fa fa-check"></i><b>1.3</b> Concrete classes</a><ul>
<li class="chapter" data-level="1.3.1" data-path="panels.html"><a href="panels.html#reduceddimensionplot"><i class="fa fa-check"></i><b>1.3.1</b> <code>ReducedDimensionPlot</code></a></li>
<li class="chapter" data-level="1.3.2" data-path="panels.html"><a href="panels.html#featureassayplot"><i class="fa fa-check"></i><b>1.3.2</b> <code>FeatureAssayPlot</code></a></li>
<li class="chapter" data-level="1.3.3" data-path="panels.html"><a href="panels.html#columndataplot"><i class="fa fa-check"></i><b>1.3.3</b> <code>ColumnDataPlot</code></a></li>
<li class="chapter" data-level="1.3.4" data-path="panels.html"><a href="panels.html#sampleassayplot"><i class="fa fa-check"></i><b>1.3.4</b> <code>SampleAssayPlot</code></a></li>
<li class="chapter" data-level="1.3.5" data-path="panels.html"><a href="panels.html#rowdataplot"><i class="fa fa-check"></i><b>1.3.5</b> <code>RowDataPlot</code></a></li>
<li class="chapter" data-level="1.3.6" data-path="panels.html"><a href="panels.html#columndatatable"><i class="fa fa-check"></i><b>1.3.6</b> <code>ColumnDataTable</code></a></li>
<li class="chapter" data-level="1.3.7" data-path="panels.html"><a href="panels.html#rowdatatable"><i class="fa fa-check"></i><b>1.3.7</b> <code>RowDataTable</code></a></li>
<li class="chapter" data-level="1.3.8" data-path="panels.html"><a href="panels.html#complexheatmapplot"><i class="fa fa-check"></i><b>1.3.8</b> <code>ComplexHeatmapPlot</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="api.html"><a href="api.html"><i class="fa fa-check"></i><b>2</b> Panel generics</a><ul>
<li class="chapter" data-level="2.1" data-path="panels.html"><a href="panels.html#overview"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="api.html"><a href="api.html#parameter-set-up"><i class="fa fa-check"></i><b>2.2</b> Parameter set-up</a></li>
<li class="chapter" data-level="2.3" data-path="api.html"><a href="api.html#defining-the-user-interface"><i class="fa fa-check"></i><b>2.3</b> Defining the user interface</a><ul>
<li class="chapter" data-level="2.3.1" data-path="api.html"><a href="api.html#in-general"><i class="fa fa-check"></i><b>2.3.1</b> In general</a></li>
<li class="chapter" data-level="2.3.2" data-path="api.html"><a href="api.html#the-dotplot-visual-interface"><i class="fa fa-check"></i><b>2.3.2</b> The <code>DotPlot</code> visual interface</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="api.html"><a href="api.html#creating-observers"><i class="fa fa-check"></i><b>2.4</b> Creating observers</a></li>
<li class="chapter" data-level="2.5" data-path="api.html"><a href="api.html#defining-panel-outputs"><i class="fa fa-check"></i><b>2.5</b> Defining panel outputs</a><ul>
<li class="chapter" data-level="2.5.1" data-path="api.html"><a href="api.html#in-general-1"><i class="fa fa-check"></i><b>2.5.1</b> In general</a></li>
<li class="chapter" data-level="2.5.2" data-path="api.html"><a href="api.html#for-dotplots"><i class="fa fa-check"></i><b>2.5.2</b> For <code>DotPlot</code>s</a></li>
<li class="chapter" data-level="2.5.3" data-path="api.html"><a href="api.html#for-metadata-dotplots"><i class="fa fa-check"></i><b>2.5.3</b> For metadata <code>DotPlot</code>s</a></li>
<li class="chapter" data-level="2.5.4" data-path="api.html"><a href="api.html#for-tables"><i class="fa fa-check"></i><b>2.5.4</b> For <code>Table</code>s</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="api.html"><a href="api.html#handling-selections"><i class="fa fa-check"></i><b>2.6</b> Handling selections</a><ul>
<li class="chapter" data-level="2.6.1" data-path="api.html"><a href="api.html#multiple"><i class="fa fa-check"></i><b>2.6.1</b> Multiple</a></li>
<li class="chapter" data-level="2.6.2" data-path="api.html"><a href="api.html#single"><i class="fa fa-check"></i><b>2.6.2</b> Single</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="server.html"><a href="server.html"><i class="fa fa-check"></i><b>3</b> Application state</a><ul>
<li class="chapter" data-level="3.1" data-path="panels.html"><a href="panels.html#overview"><i class="fa fa-check"></i><b>3.1</b> Overview</a></li>
<li class="chapter" data-level="3.2" data-path="server.html"><a href="server.html#updating-parameters"><i class="fa fa-check"></i><b>3.2</b> Updating parameters</a></li>
<li class="chapter" data-level="3.3" data-path="server.html"><a href="server.html#using-the-memory"><i class="fa fa-check"></i><b>3.3</b> Using the memory</a></li>
<li class="chapter" data-level="3.4" data-path="server.html"><a href="server.html#responding-to-events"><i class="fa fa-check"></i><b>3.4</b> Responding to events</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="developing.html"><a href="developing.html"><i class="fa fa-check"></i><b>4</b> Developing new panels</a><ul>
<li class="chapter" data-level="4.1" data-path="developing.html"><a href="developing.html#create-a-new-s4-class"><i class="fa fa-check"></i><b>4.1</b> Create a new S4 class</a></li>
<li class="chapter" data-level="4.2" data-path="developing.html"><a href="developing.html#add-a-constructor-function"><i class="fa fa-check"></i><b>4.2</b> Add a constructor function</a></li>
<li class="chapter" data-level="4.3" data-path="developing.html"><a href="developing.html#set-the-panel-name-in-the-gui"><i class="fa fa-check"></i><b>4.3</b> Set the panel name in the GUI</a></li>
<li class="chapter" data-level="4.4" data-path="developing.html"><a href="developing.html#define-the-commands-generating-a-plot-output"><i class="fa fa-check"></i><b>4.4</b> Define the commands generating a plot output</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html"><i class="fa fa-check"></i><b>5</b> Dynamic reduced dimensions</a><ul>
<li class="chapter" data-level="5.1" data-path="panels.html"><a href="panels.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#class-basics"><i class="fa fa-check"></i><b>5.2</b> Class basics</a></li>
<li class="chapter" data-level="5.3" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#setting-up-the-interface"><i class="fa fa-check"></i><b>5.3</b> Setting up the interface</a></li>
<li class="chapter" data-level="5.4" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#creating-the-observers"><i class="fa fa-check"></i><b>5.4</b> Creating the observers</a></li>
<li class="chapter" data-level="5.5" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#making-the-plot"><i class="fa fa-check"></i><b>5.5</b> Making the plot</a></li>
<li class="chapter" data-level="5.6" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#finishing-touches"><i class="fa fa-check"></i><b>5.6</b> Finishing touches</a></li>
<li class="chapter" data-level="5.7" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#in-action"><i class="fa fa-check"></i><b>5.7</b> In action</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dynamic-differential-expression.html"><a href="dynamic-differential-expression.html"><i class="fa fa-check"></i><b>6</b> Dynamic differential expression</a><ul>
<li class="chapter" data-level="6.1" data-path="panels.html"><a href="panels.html#overview"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#class-basics"><i class="fa fa-check"></i><b>6.2</b> Class basics</a></li>
<li class="chapter" data-level="6.3" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#setting-up-the-interface"><i class="fa fa-check"></i><b>6.3</b> Setting up the interface</a></li>
<li class="chapter" data-level="6.4" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#creating-the-observers"><i class="fa fa-check"></i><b>6.4</b> Creating the observers</a></li>
<li class="chapter" data-level="6.5" data-path="dynamic-differential-expression.html"><a href="dynamic-differential-expression.html#making-the-table"><i class="fa fa-check"></i><b>6.5</b> Making the table</a></li>
<li class="chapter" data-level="6.6" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#finishing-touches"><i class="fa fa-check"></i><b>6.6</b> Finishing touches</a></li>
<li class="chapter" data-level="6.7" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#in-action"><i class="fa fa-check"></i><b>6.7</b> In action</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="annotated-gene-list.html"><a href="annotated-gene-list.html"><i class="fa fa-check"></i><b>7</b> Annotated gene list</a><ul>
<li class="chapter" data-level="7.1" data-path="panels.html"><a href="panels.html#overview"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#class-basics"><i class="fa fa-check"></i><b>7.2</b> Class basics</a></li>
<li class="chapter" data-level="7.3" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#setting-up-the-interface"><i class="fa fa-check"></i><b>7.3</b> Setting up the interface</a></li>
<li class="chapter" data-level="7.4" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#creating-the-observers"><i class="fa fa-check"></i><b>7.4</b> Creating the observers</a></li>
<li class="chapter" data-level="7.5" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#in-action"><i class="fa fa-check"></i><b>7.5</b> In action</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="gene-ontology-table.html"><a href="gene-ontology-table.html"><i class="fa fa-check"></i><b>8</b> Gene ontology table</a><ul>
<li class="chapter" data-level="8.1" data-path="panels.html"><a href="panels.html#overview"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#class-basics"><i class="fa fa-check"></i><b>8.2</b> Class basics</a></li>
<li class="chapter" data-level="8.3" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#setting-up-the-interface"><i class="fa fa-check"></i><b>8.3</b> Setting up the interface</a></li>
<li class="chapter" data-level="8.4" data-path="gene-ontology-table.html"><a href="gene-ontology-table.html#generating-the-output"><i class="fa fa-check"></i><b>8.4</b> Generating the output</a></li>
<li class="chapter" data-level="8.5" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#creating-the-observers"><i class="fa fa-check"></i><b>8.5</b> Creating the observers</a></li>
<li class="chapter" data-level="8.6" data-path="api.html"><a href="api.html#handling-selections"><i class="fa fa-check"></i><b>8.6</b> Handling selections</a></li>
<li class="chapter" data-level="8.7" data-path="dynamic-reduced-dimensions.html"><a href="dynamic-reduced-dimensions.html#in-action"><i class="fa fa-check"></i><b>8.7</b> In action</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Extending <em>iSEE</em></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="developing" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Developing new panels</h1>
<p>First, we need to load the <em><a href="https://bioconductor.org/packages/3.11/iSEE">iSEE</a></em> package for this chapter.
This action imports all the builtin panel class definitions, including the virtual class <code>Panel</code> that is the base class for any <em><a href="https://bioconductor.org/packages/3.11/iSEE">iSEE</a></em> panel class.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="developing.html#cb168-1"></a><span class="kw">library</span>(iSEE)</span></code></pre></div>
<p>We also set up an example using our favorite dataset, creating a <code>SingleCellExperiment</code> object with some precomputed dimensionality reduction results.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="developing.html#cb169-1"></a><span class="kw">library</span>(scRNAseq)</span>
<span id="cb169-2"><a href="developing.html#cb169-2"></a>sce &lt;-<span class="st"> </span><span class="kw">ReprocessedAllenData</span>(<span class="dt">assays=</span><span class="st">&quot;tophat_counts&quot;</span>)</span>
<span id="cb169-3"><a href="developing.html#cb169-3"></a></span>
<span id="cb169-4"><a href="developing.html#cb169-4"></a><span class="kw">library</span>(scater)</span>
<span id="cb169-5"><a href="developing.html#cb169-5"></a>sce &lt;-<span class="st"> </span><span class="kw">logNormCounts</span>(sce, <span class="dt">exprs_values=</span><span class="st">&quot;tophat_counts&quot;</span>)</span>
<span id="cb169-6"><a href="developing.html#cb169-6"></a>sce &lt;-<span class="st"> </span><span class="kw">runPCA</span>(sce, <span class="dt">ncomponents=</span><span class="dv">4</span>)</span>
<span id="cb169-7"><a href="developing.html#cb169-7"></a>sce &lt;-<span class="st"> </span><span class="kw">runTSNE</span>(sce)</span></code></pre></div>
<div id="create-a-new-s4-class" class="section level2">
<h2><span class="header-section-number">4.1</span> Create a new S4 class</h2>
<p>In the chapter <a href="panels.html#panels">Panel classes</a>, we saw how each type of panel is defined as an S4 class, organised in a hierarchy that allows new panel classes to inherit sets of properties and functionality from parent classes.</p>
<p>As a result, developing a new panel type starts with the creation of a new class that inherits from the <code>Panel</code> class.</p>
<p>While it is possible to create a new panel class that directly inherits from the top-most virtual <code>Panel</code> class, this is the most advanced use case that we will describe in later chapters. <!-- TODO: cross-reference when done. --></p>
<p>Instead, new concrete panel classes can be rapidly derived from other concrete parent panel classes, using the inheritance relationships between classes to reuse properties and functionality defined in the parent classes and its own parent classes.</p>
<p>The choice of a parent class depends on the properties that we want that new panel class to start with.
For instance, to create a panel that inherits all the functionality of the <code>ReducedDimensionPlot</code> panel type, we simply define a new class that extends that class.
For example in this chapter, we call that new class <code>RedDimHexPlot</code>.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="developing.html#cb170-1"></a><span class="kw">setClass</span>(<span class="st">&quot;RedDimHexPlot&quot;</span>, <span class="dt">contains=</span><span class="st">&quot;ReducedDimensionPlot&quot;</span>)</span></code></pre></div>
</div>
<div id="add-a-constructor-function" class="section level2">
<h2><span class="header-section-number">4.2</span> Add a constructor function</h2>
<p>At this point, it is already possible to create instances of the new panel class.
However, to facilitate this, new panels should provide a constructor function - best practice is to name it identically to the class - to accept arbitrary arguments controlling the initialization of new panel instances created by the function <code>new()</code>.</p>
<p>Here, we define a simple constructor function that passes all incoming arguments <em>as is</em> to <code>new()</code>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="developing.html#cb171-1"></a>RedDimHexPlot &lt;-<span class="st"> </span><span class="cf">function</span>(...) {</span>
<span id="cb171-2"><a href="developing.html#cb171-2"></a>    <span class="kw">new</span>(<span class="st">&quot;RedDimHexPlot&quot;</span>, ...)</span>
<span id="cb171-3"><a href="developing.html#cb171-3"></a>}</span></code></pre></div>
<p>At this point, we can already use instances of this new panel class in <em><a href="https://bioconductor.org/packages/3.11/iSEE">iSEE</a></em> apps.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="developing.html#cb172-1"></a>RedDimHexPlot1 &lt;-<span class="st"> </span><span class="kw">RedDimHexPlot</span>()</span>
<span id="cb172-2"><a href="developing.html#cb172-2"></a>initial &lt;-<span class="st"> </span><span class="kw">list</span>(RedDimHexPlot1)</span>
<span id="cb172-3"><a href="developing.html#cb172-3"></a>app &lt;-<span class="st"> </span><span class="kw">iSEE</span>(sce, <span class="dt">initial =</span> initial)</span></code></pre></div>
<p>However, that would not be very exciting as instances of this new panel class would behave exactly like the those of the parent <code>ReducedDimensionPlot</code> class itself.
To illustrate this, the following code chunk initializes an app displaying an instance of the new <code>RedDimHexPlot</code> and its parent <code>ReducedDimensionPlot</code> side by side.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="developing.html#cb173-1"></a>RedDimHexPlot1 &lt;-<span class="st"> </span><span class="kw">RedDimHexPlot</span>()</span>
<span id="cb173-2"><a href="developing.html#cb173-2"></a>ReducedDimensionPlot1 &lt;-<span class="st"> </span><span class="kw">ReducedDimensionPlot</span>()</span>
<span id="cb173-3"><a href="developing.html#cb173-3"></a>initial &lt;-<span class="st"> </span><span class="kw">list</span>(RedDimHexPlot1, ReducedDimensionPlot1)</span>
<span id="cb173-4"><a href="developing.html#cb173-4"></a>app &lt;-<span class="st"> </span><span class="kw">iSEE</span>(sce, <span class="dt">initial =</span> initial)</span></code></pre></div>
</div>
<div id="set-the-panel-name-in-the-gui" class="section level2">
<h2><span class="header-section-number">4.3</span> Set the panel name in the GUI</h2>
<p>The panel class that we created so far also inherited the name of the parent panel class.
In other words, instances of both classes are entirely indistinguishable from each other in the GUI.</p>
<p>The name of each panel displayed in the GUI is defined by the method <code>.fullName()</code>.
To clearly distinguish the new panel class in the GUI, we overwrite this method to display a name different from the parent class.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="developing.html#cb174-1"></a><span class="kw">setMethod</span>(<span class="st">&quot;.fullName&quot;</span>, <span class="st">&quot;RedDimHexPlot&quot;</span>, <span class="cf">function</span>(x) <span class="st">&quot;Reduced dimension hexagonal plot&quot;</span>)</span></code></pre></div>
<p>With that, launching <code>app</code> again now highlights how panels of the new class now display a different title from the parent class.</p>
</div>
<div id="define-the-commands-generating-a-plot-output" class="section level2">
<h2><span class="header-section-number">4.4</span> Define the commands generating a plot output</h2>
<p>Importantly, the API separates the generation of commands processing data from <code>sce</code> into a data-frame, from the generation of commands producing a <code>ggplot</code> object using the processed data-frame.
If a new panel class derived from <code>DotPlot</code> is meant to process data in the same way as its parent panel, only to display it in a different way, it is then possible to overwrite only the method <code>.generateDotPlot()</code>.
Meanwhile, the data preprocessing will be implicitly handled by the other API methods inherited from the parent class.</p>
<p>Importantly, the method <code>.generateDotPlot()</code> requires two key arguments: <code>labels</code> provides the plot labels for each of the aesthetics in the plot data, and <code>envir</code> provides the environment in which the plotting commands are to be evaluated to produce the <code>ggplot</code> object.</p>
<p>In particular, the contract offered by iSEE to panel developers promises the presence of certain variables in <code>envir</code>, that <code>.generateDotPlot()</code> can rely on.
Using those environment variables, <code>.generateDotPlot()</code> can make decisions altering the plotting commands and the resulting <code>ggplot</code> object.
For instance, the most important environment variable is <code>plot.data</code>, the data-frame that contains one row per data point to display in <code>DotPlot</code> panels.</p>
<p>Readers should refer to the <strong>“Generating the ggplot object”</strong> section of <code>help(".generateDotPlot", "iSEE")</code> for more information.</p>
<p>As an example, we overwrite the method <code>.generateDotPlot()</code> for the new class <code>RedDimHexPlot</code> to simply show the number of data points in the plotting area as a heatmap dividing the plane into regular hexagons.
Notably, the contract described above guarantees that the function can immediately rely on the <code>plot.data</code> data-frame that is computed by methods defined for the parent class <code>ReducedDimensionPlot</code>.
We also use the precomputed aesthetic <code>labels</code> associated with each column of <code>plot.data</code>, while setting a fixed label <code>"Count"</code> for the <code>fill</code> aesthetic associated with the count of observation in each hexagonal bin.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="developing.html#cb175-1"></a><span class="kw">setMethod</span>(<span class="st">&quot;.generateDotPlot&quot;</span>, <span class="st">&quot;RedDimHexPlot&quot;</span>, <span class="cf">function</span>(x, labels, envir) {</span>
<span id="cb175-2"><a href="developing.html#cb175-2"></a>    <span class="kw">stopifnot</span>(<span class="kw">require</span>(ggplot2))</span>
<span id="cb175-3"><a href="developing.html#cb175-3"></a>    </span>
<span id="cb175-4"><a href="developing.html#cb175-4"></a>    plot_cmds &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb175-5"><a href="developing.html#cb175-5"></a>    plot_cmds[[<span class="st">&quot;ggplot&quot;</span>]] &lt;-<span class="st"> &quot;ggplot() +&quot;</span></span>
<span id="cb175-6"><a href="developing.html#cb175-6"></a>    </span>
<span id="cb175-7"><a href="developing.html#cb175-7"></a>    <span class="co"># Adding hexbins to the plot.</span></span>
<span id="cb175-8"><a href="developing.html#cb175-8"></a>    plot_cmds[[<span class="st">&quot;hex&quot;</span>]] &lt;-<span class="st"> &quot;geom_hex(aes(X, Y), plot.data) +&quot;</span></span>
<span id="cb175-9"><a href="developing.html#cb175-9"></a>    plot_cmds[[<span class="st">&quot;labs&quot;</span>]] &lt;-<span class="st"> &quot;labs(fill=&#39;Count&#39;) +&quot;</span></span>
<span id="cb175-10"><a href="developing.html#cb175-10"></a>    plot_cmds[[<span class="st">&quot;labs&quot;</span>]] &lt;-<span class="st"> </span><span class="kw">sprintf</span>(</span>
<span id="cb175-11"><a href="developing.html#cb175-11"></a>        <span class="st">&quot;labs(x=&#39;%s&#39;, y=&#39;%s&#39;, title=&#39;%s&#39;, fill=&#39;%s&#39;) +&quot;</span>,</span>
<span id="cb175-12"><a href="developing.html#cb175-12"></a>        labels<span class="op">$</span>X, labels<span class="op">$</span>Y, labels<span class="op">$</span>title, <span class="st">&quot;Count&quot;</span></span>
<span id="cb175-13"><a href="developing.html#cb175-13"></a>        )</span>
<span id="cb175-14"><a href="developing.html#cb175-14"></a>    plot_cmds[[<span class="st">&quot;theme_base&quot;</span>]] &lt;-<span class="st"> &quot;theme_bw() +&quot;</span></span>
<span id="cb175-15"><a href="developing.html#cb175-15"></a>    plot_cmds[[<span class="st">&quot;theme_legend&quot;</span>]] &lt;-<span class="st"> &quot;theme(legend.position = &#39;bottom&#39;)&quot;</span></span>
<span id="cb175-16"><a href="developing.html#cb175-16"></a>    </span>
<span id="cb175-17"><a href="developing.html#cb175-17"></a>    gg_plot &lt;-<span class="st"> </span><span class="kw">eval</span>(<span class="kw">parse</span>(<span class="dt">text=</span>plot_cmds), envir)</span>
<span id="cb175-18"><a href="developing.html#cb175-18"></a>    </span>
<span id="cb175-19"><a href="developing.html#cb175-19"></a>    <span class="kw">list</span>(<span class="dt">plot=</span>gg_plot, <span class="dt">commands=</span>plot_cmds)</span>
<span id="cb175-20"><a href="developing.html#cb175-20"></a>})</span></code></pre></div>
<p>Running <code>app</code> again highlights how the <code>RedDimHexPlot</code> panel fills each hexagonal bin with a color indicating the number of data points present in the corresponding area in the <code>ReducedDimensionPlot</code> panel.</p>
<!-- TODO:
second fastest visual result:
override the plotting function
-->
<!-- TODO: add a UI (preferably that affects XY) -->
<!-- TODO: add an observer -->
<!-- TODO: override the XY data logic -->
<!-- TODO: override the plot logic (again, see above) -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="server.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dynamic-reduced-dimensions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["iSEE-book.pdf", "iSEE-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
